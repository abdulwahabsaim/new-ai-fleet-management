<%- include('../partials/header') %>

<div class="container-fluid">
    <div class="d-sm-flex align-items-center justify-content-between mb-4 mt-4">
        <h1 class="h3 mb-0 text-dark"><%= vehicle.make %> <%= vehicle.model %></h1>
        <div>
            <a href="/vehicles/<%= vehicle._id %>/edit" class="btn btn-warning shadow-sm me-2">
                <i class="bi bi-pencil-square me-1"></i> Edit
            </a>
            <form action="/vehicles/<%= vehicle._id %>?_method=DELETE" method="POST" class="d-inline" onsubmit="return confirm('Are you sure you want to delete this vehicle?');">
                <button type="submit" class="btn btn-danger shadow-sm">
                    <i class="bi bi-trash me-1"></i> Delete
                </button>
            </form>
        </div>
    </div>

    <%- include('../partials/flash_messages') %>

    <div class="row">
        <!-- Vehicle Details Card -->
        <div class="col-lg-6 mb-4">
            <div class="card shadow-sm h-100">
                <div class="card-header py-3">
                    <h6 class="m-0 fw-bold text-primary">Vehicle Details</h6>
                </div>
                <div class="card-body">
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item d-flex justify-content-between"><strong>Year:</strong> <span><%= vehicle.year %></span></li>
                        <li class="list-group-item d-flex justify-content-between"><strong>VIN:</strong> <span><%= vehicle.vin %></span></li>
                        <li class="list-group-item d-flex justify-content-between"><strong>License Plate:</strong> <span><%= vehicle.licensePlate %></span></li>
                        <li class="list-group-item d-flex justify-content-between"><strong>Mileage:</strong> <span><%= vehicle.mileage.toLocaleString() %> km</span></li>
                        <li class="list-group-item d-flex justify-content-between"><strong>Status:</strong> <span class="badge bg-<%= vehicle.status === 'active' ? 'success' : 'warning' %>"><%= vehicle.status %></span></li>
                        <li class="list-group-item d-flex justify-content-between">
                            <strong>Avg. Fuel Efficiency:</strong> 
                            <% if (vehicle.averageFuelEfficiency) { %>
                                <span class="fw-bold"><%= vehicle.averageFuelEfficiency.toFixed(2) %> L/100km</span>
                            <% } else { %>
                                <span class="text-muted">No data</span>
                            <% } %>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- AI Prediction Card -->
        <div class="col-lg-6 mb-4">
            <div class="card shadow-sm h-100 border-left-<%= vehicle.maintenancePrediction.isNeeded ? 'danger' : 'success' %>">
                <div class="card-header py-3">
                    <h6 class="m-0 fw-bold text-primary">AI Maintenance Prediction</h6>
                </div>
                <div class="card-body text-center d-flex flex-column justify-content-center">
                    <% if (vehicle.maintenancePrediction.isNeeded) { %>
                        <i class="bi bi-exclamation-triangle-fill display-3 text-danger"></i>
                        <h4 class="mt-3">Maintenance Recommended!</h4>
                    <% } else { %>
                        <i class="bi bi-check-circle-fill display-3 text-success"></i>
                        <h4 class="mt-3">Vehicle Appears Healthy</h4>
                    <% } %>
                    <p class="mt-3"><%= vehicle.maintenancePrediction.message %></p>
                    <p class="text-muted small mt-auto mb-0">Last checked: <%= new Date(vehicle.maintenancePrediction.predictedAt).toLocaleString() %></p>
                </div>
            </div>
        </div>
    </div>
</div>

<%- include('../partials/footer') %>